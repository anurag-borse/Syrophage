@model List<Syrophage.Models.Blog>

@{
    Layout = null;
}

<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>

    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href="~/admin/assets/libs/flot/css/float-chart.css" rel="stylesheet" />
    <link href="~/admin/dist/css/style.css" rel="stylesheet" />
    <link href="~/admin/dist/css/style.min.css" rel="stylesheet" />

    <link href="~/admin/assets/libs/datatables.net-bs4/css/datatables.bootstrap4.css" rel="stylesheet" />

    <script src="~/admin/assets/extra-libs/datatables/datatables.min.js"></script>

    <link href="~/assets/css/flash.css" rel="stylesheet" />

</head>
<body>


    <div id="main-wrapper"
         data-layout="vertical"
         data-navbarbg="skin5"
         data-sidebartype="full"
         data-sidebar-position="absolute"
         data-header-position="absolute"
         data-boxed-layout="full">


        <partial name="AdminNavbar" />

        <partial name="AdminSidebar" />


        <div class="page-wrapper">
            <div class="page-breadcrumb">
                <div class="row">
                    <div class="col-12 d-flex no-block align-items-center">
                        <h4 class="page-title"></h4>
                        <div class="ms-auto text-end">
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-fluid" id="userData">

                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title mb-0">USERS</h5>
                            </div>
                            <table class="table" id="usersTable">
                                <thead>
                                    <tr>
                                        <th scope="col">Id</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Email</th>
                                        <th scope="col">Title</th>
                                        <th scope="col">Description</th>
                                        <th scope="col">Image</th>
                                        <th scope="col">Type</th>
                                        <th scope="col">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var user in Model)
                                    {
                                        <tr>
                                            <th scope="row">@user.id</th>
                                            <td>@user.Name</td>
                                            <td>@user.email</td>
                                            <td>@user.Title</td>
                                            <td>
                                                <!-- Button to trigger description modal -->
                                                <button type="button" class="btn btn-link read-description" data-user-id="@user.id">Read</button>

                                                <!-- Hidden modal for description -->
                                                <div class="modal" id="descriptionModal_@user.id" style="display: none;">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title">Blog Description</h5>
                                                                <button type="button" class="close" data-dismiss="modal">×</button>
                                                            </div>
                                                            <div class="modal-body" style="max-height: 200px; overflow-y: auto; position: relative;">
                                                                <!-- Adjust max-height as needed -->
                                                                @user.BlogDesc
                                                                <div class="overlay"></div> <!-- Overlay for blurred background -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <img src="@user.ImageUrl" style="width: 50px; height: 50px;" />
                                            </td>
                                            <td>@user.Type</td>
                                            <td>


                                                <button data-activated="@(user.IsDisplay ?? false)" onclick="toggleActivation(@user.id, this)" class="btn btn-@(user.IsDisplay == true ? "danger" : "success")">@(user.IsDisplay == true ? "Dont-Show" : "Show")</button>
                                            </td>
                                        </tr>
                                    }



                                </tbody>
                            </table>


                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>
    </body>
    </html>


    <script>
    function toggleActivation(id, button) {
        var isActivated = $(button).data('activated');
        $.ajax({
            url: '/Admin/ToggleActivation1',
            type: 'POST',
            data: { id: id, isActivated: isActivated },
            success: function (response) {
                if (response.success) {
                    var newIsActivated = !isActivated;
                    $(button).data('activated', newIsActivated);
                    $(button).text(newIsActivated ? "De-Activate" : "Activate");
                    $(button).removeClass('badge-success badge-danger');
                    $(button).addClass(newIsActivated ? 'badge-success' : 'badge-danger');

                    // Refresh the user data
                    $.ajax({
                        url: '/Admin/AllBlog',
                        type: 'GET',
                        success: function (html) {
                            // Replace the current user data with the new user data
                            $('#userData').replaceWith(
                                $(html).find('#userData')
                            );
                        }
                    });
                } else {
                    // Handle error
                    console.error('Failed to toggle activation status');
                }
            }
        });
    }
















    document.addEventListener("DOMContentLoaded", function () {
        // Get all buttons with class 'read-description'
        var buttons = document.querySelectorAll('.read-description');

        // Add click event listener to each button
        buttons.forEach(function (button) {
            button.addEventListener('click', function () {
                // Get the user ID from the button's data attribute
                var userId = this.dataset.userId;
                // Show the modal for the corresponding user ID
                document.getElementById('descriptionModal_' + userId).style.display = 'block';
            });
        });

        // Get all close buttons in modals
        var closeButtons = document.querySelectorAll('.close');

        // Add click event listener to each close button
        closeButtons.forEach(function (closeButton) {
            closeButton.addEventListener('click', function () {
                // Hide the modal when close button is clicked
                this.closest('.modal').style.display = 'none';
            });
        });
    });
        </script>


    <script src="~/admin/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="~/admin/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
    <script src="~/admin/assets/extra-libs/sparkline/sparkline.js"></script>
    <script src="~/admin/dist/js/waves.js"></script>
    <script src="~/admin/dist/js/sidebarmenu.js"></script>
    <script src="~/admin/dist/js/custom.min.js"></script>
    <script src="~/admin/dist/js/pages/dashboards/dashboard1.js"></script>
    <script src="~/admin/assets/extra-libs/datatables/datatables.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>